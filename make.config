# JitterTrap Build Configuration
# ==============================
#
# This file contains compile-time configuration options. Override any of
# these by setting them on the command line or in the environment:
#
#   make SAMPLE_PERIOD_US=500 WEB_SERVER_PORT=8080
#
# Or export them before running make:
#
#   export SAMPLE_PERIOD_US=500
#   make
#

# ------------------------------------------------------------------------------
# Branding
# ------------------------------------------------------------------------------

# Product name displayed in the web UI
ifndef PRODUCT_BRANDING
PRODUCT_BRANDING = JitterTrap
endif

# ------------------------------------------------------------------------------
# Network Capture Settings
# ------------------------------------------------------------------------------

# Sampling period in microseconds. Lower values give finer granularity but
# increase CPU usage. Typical values: 1000 (1ms), 500, 100.
ifndef SAMPLE_PERIOD_US
SAMPLE_PERIOD_US = 1000
endif

# Maximum length of network interface names (matches kernel IFNAMSIZ)
MAX_IFACE_LEN = 16

# Default allowed interfaces for capture (colon-separated list).
# Empty string means all interfaces are allowed.
# Can be overridden at runtime with: jt-server -a "eth0:eth1"
ifndef ALLOWED_IFACES
ALLOWED_IFACES = ""
endif

# ------------------------------------------------------------------------------
# Web Server Settings
# ------------------------------------------------------------------------------

# Default port for the web server (can be overridden at runtime with -p)
ifndef WEB_SERVER_PORT
WEB_SERVER_PORT = 80
endif

# Default path to web content (can be overridden at runtime with -r)
ifndef WEB_SERVER_DOCUMENT_ROOT
WEB_SERVER_DOCUMENT_ROOT = /var/lib/jittertrap
endif

# ------------------------------------------------------------------------------
# Performance Tuning
# ------------------------------------------------------------------------------

# CPU core for the real-time sampling thread (0 = first core).
# This thread has the strictest timing requirement (1ms tick).
# Pin to an isolated core for best performance on multi-core systems.
ifndef RT_CPU
RT_CPU = 0
endif

# CPU core for the top talker / packet capture threads.
# Default: CPU 1 (separate from sampling thread on RT_CPU=0).
# For single-core systems, set RT_CPU_TOPTALK=0 to match RT_CPU.
ifndef RT_CPU_TOPTALK
RT_CPU_TOPTALK = 1
endif

# Number of time intervals to track for flow statistics.
# Higher values use more memory but allow longer historical views.
ifndef INTERVAL_COUNT
INTERVAL_COUNT = 8
endif

# Maximum number of concurrent flows to track.
# Higher values use more memory. Flows beyond this limit are aggregated.
ifndef MAX_FLOW_COUNT
MAX_FLOW_COUNT = 100
endif

# Maximum size of JSON messages (bytes). Increase if SDP messages are truncated.
ifndef MAX_JSON_MSG_LEN
MAX_JSON_MSG_LEN = 65536
endif

# Maximum size of JSON token strings
ifndef MAX_JSON_TOKEN_LEN
MAX_JSON_TOKEN_LEN = 256
endif

# ------------------------------------------------------------------------------
# Feature Flags
# ------------------------------------------------------------------------------

# Set to 1 to disable network impairment features (netem integration)
# DISABLE_IMPAIRMENTS = 1

# Set to 1 to disable packet capture download feature
# DISABLE_PCAP = 1

# Enable WebRTC video playback (allows viewing video streams in browser).
# Requires libdatachannel. We bundle libdatachannel 0.23+ because:
# - Ubuntu 22.04 doesn't have libdatachannel in repos
# - Fedora's libdatachannel 0.21.x has a bug affecting H.265 playback
# Set to 0 to disable WebRTC playback.
ifndef ENABLE_WEBRTC_PLAYBACK
ENABLE_WEBRTC_PLAYBACK = 1
endif
